<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Svensk OSINT – Events → Intentioner (interaktiv)</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="dot"></div>
      <div>
        <div class="title">EVENTS → INTENTIONER</div>
        <div class="subtitle">Analys av EVENTS (veckobrevskartan) + kapacitetsmodell (Intentioner/Facilitering/Resurser/Tillfälle)</div>
      </div>
    </div>

    <div class="actions">
      <button id="btnFS" class="btn">Helskärm (graf)</button>
      <button id="btnReset" class="btn">Återställ vy</button>
      <button id="btnExportModel" class="btn">Exportera intentioner-JSON</button>
      <button id="btnExportEvents" class="btn">Exportera EVENTS-JSON</button>
      <label class="btn filebtn">
        Importera EVENTS-JSON <input id="fileImportEvents" type="file" accept="application/json" />
      </label>
    </div>
  </header>

  <main class="layout">
    <section class="left">
      <div class="card">
        <div class="cardhead">
          <h2>Filter & styrning</h2>
          <div class="pill">Live</div>
        </div>

        <div class="controls">
          <div class="row">
            <label>Datumintervall</label>
            <div class="range2">
              <input id="dateFrom" type="date" />
              <input id="dateTo" type="date" />
            </div>
          </div>

          <div class="row">
            <label>Kategori</label>
            <select id="selCat">
              <option value="ALL" selected>Alla</option>
            </select>
          </div>

          <div class="row">
            <label>Land</label>
            <select id="selCountry">
              <option value="ALL" selected>Alla</option>
            </select>
          </div>

          <div class="row">
            <label>Minsta trolighetsnivå</label>
            <select id="selMinLikelihood">
              <option value="tveksamt">Tveksamt</option>
              <option value="mojligt">Möjligt</option>
              <option value="troligt">Troligt</option>
              <option value="sannolikt">Sannolikt</option>
              <option value="bekraftat" selected>Bekräftat</option>
            </select>
          </div>

          <div class="row">
            <label class="chk">
              <input type="checkbox" id="chkClamp" checked />
              Begränsa till 0–100%
            </label>
          </div>

          <div class="row">
            <label class="chk">
              <input type="checkbox" id="chkKeywordNodes" checked />
              Visa nyckelordsnoder i grafen
            </label>
          </div>

          <div class="row">
            <label>Nyckelordsfilter</label>
            <input id="txtKW" placeholder="t.ex. cable, sabotage, drone..." />
          </div>

          <div class="hint">
            <b>Tips:</b> Lägg dina EVENTS i <code>events.js</code> som <code>const EVENTS = [...]</code>.
            Om du inte vill ha server/fetch så är detta mest robust på GitHub Pages.
          </div>
        </div>
      </div>

      <div class="card">
        <div class="cardhead">
          <h2>Kapacitetsmodell</h2>
          <div class="pill" id="pillScenario">Viktad</div>
        </div>

        <div class="grid2">
          <div class="mini">
            <div class="k">Total kapacitet</div>
            <div class="v" id="capTotal">–</div>
          </div>
          <div class="mini">
            <div class="k">Events i urval</div>
            <div class="v" id="nEvents">–</div>
          </div>
          <div class="mini">
            <div class="k">Kategorier i urval</div>
            <div class="v" id="nCats">–</div>
          </div>
          <div class="mini">
            <div class="k">Länder i urval</div>
            <div class="v" id="nCountries">–</div>
          </div>
        </div>

        <div class="subgrid">
          <div class="box">
            <div class="boxt">Dimensioner (0–100)</div>
            <div id="dimBars"></div>
          </div>
          <div class="box">
            <div class="boxt">Radar</div>
            <svg id="radar" viewBox="0 0 360 320" aria-label="radar"></svg>
          </div>
        </div>

        <div class="smallmuted">
          Beräkning: varje event → (risk 1–5) × trolighetsvikt. Dimension bestäms av kategori via mappning (kan justeras i <code>app.js</code>).
        </div>
      </div>

      <div class="card">
        <div class="cardhead">
          <h2>Tidslinje</h2>
          <div class="pill">Histogram</div>
        </div>
        <svg id="timeline" viewBox="0 0 720 180" aria-label="timeline"></svg>
        <div class="smallmuted">Antal events per vecka i urvalet.</div>
      </div>

      <div class="card">
        <div class="cardhead">
          <h2>Urval</h2>
          <div class="pill">Lista</div>
        </div>
        <div class="row inline">
          <input id="txtSearch" placeholder="Sök title/summary/url..." />
          <button id="btnClear" class="btn small">Rensa</button>
        </div>
        <div id="eventList" class="list"></div>
      </div>
    </section>

    <section class="right">
      <div id="graphCard" class="card canvas">
        <div class="cardhead">
          <h2>Länkdiagram</h2>
          <div class="pill">Kategori ↔ Land ↔ Nyckelord</div>
        </div>
        <div id="graph"></div>
        <div class="smallmuted">
          Dra noder, zooma (hjul), panorera (drag i tom yta). Klicka nod för att pin:a (låsa) eller släppa.
        </div>
      </div>

      <div class="card">
        <div class="cardhead">
          <h2>Detalj</h2>
          <div class="pill" id="detailPill">–</div>
        </div>
        <div id="detail" class="detail"></div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div>Statisk GitHub Pages. Ingen fetch för data krävs om du använder <code>events.js</code>.</div>
    <div>Exportera intentioner-JSON för att använda i din tidigare “Intentioner”-sida om du vill separera vyer.</div>
  </footer>

  <script src="events.js"></script>
  <script src="app.js"></script>
</body>
</html>
